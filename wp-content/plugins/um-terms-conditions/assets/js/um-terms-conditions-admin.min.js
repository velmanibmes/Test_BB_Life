jQuery(function(){var t=window.um_terms_conditions_agreement_email||{},a=document.forms["um-tc-agreement-email-form"],n=wp.template("tcae-progress");function s(){var e;"run"===t.state&&(jQuery("#tcae_role,#tcae_start").attr("disabled",!0).next(".spinner").css("visibility","visible"),e={user_role:a.elements.user_role.value,action:a.elements.um_adm_action.value,_wpnonce:a.elements._wpnonce.value},wp.ajax.post(e.action,e).done(function(e){"object"==typeof e&&("done"===e.state?jQuery("#tcae_role,#tcae_start").attr("disabled",!1).next(".spinner").css("visibility","hidden"):"error"===e.state?(jQuery("#tcae_role,#tcae_start").attr("disabled",!1).next(".spinner").css("visibility","hidden"),e.state=""):"pause"===t.state?e.state="pause":"run"===t.state&&s(),jQuery.extend(t,e),jQuery("#tcae_progress").replaceWith(n(t)),wp.hooks.doAction("um_tcae_ajax_run_done",e))}).fail(function(e){console.warn("UM - Terms & Conditions: tcae_ajax_run",e)}))}function e(e){e.preventDefault(),"run"!==t.state&&(t.state="run",jQuery("#tcae_progress").html(""),s())}"run"===t.state&&(jQuery("#tcae_progress").replaceWith(n(t)),s()),jQuery(a).on("submit",e).on("click","#tcae_start",e).on("click","#tcae_run",function(e){e.preventDefault(),"pause"===t.state&&(t.state="run",jQuery("#tcae_start").next(".spinner").css("visibility","visible"),jQuery("#tcae_progress").replaceWith(n(t)),s())}).on("click","#tcae_pause",function(e){e.preventDefault(),"run"===t.state&&(t.state="pause",jQuery("#tcae_start").next(".spinner").css("visibility","hidden"),jQuery("#tcae_progress").replaceWith(n(t)))}).on("click","#tcae_stop",function(e){e.preventDefault(),t.state="",jQuery("#tcae_progress").html(""),function(){var e={action:"terms_conditions_agreement_email_stop",_wpnonce:a.elements._wpnonce.value};wp.ajax.post(e.action,e).done(function(e){jQuery("#tcae_role,#tcae_start").attr("disabled",!1).next(".spinner").css("visibility","hidden"),jQuery("#tcae_progress").html(""),wp.hooks.doAction("um_tcae_ajax_stop_done",e)}).fail(function(e){console.warn("UM - Terms & Conditions: tcae_ajax_stop",e)})}()})});